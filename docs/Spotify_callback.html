<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">    
<title>LioranBoard Spotify Authentication</title>
            <style>
                .text {
                font-family: "Arial";
                font-size: 16px }
                img {
                vertical-align:middle  
                }
                code {
                    background-color: #dbdbdb;
                    padding:1px 4px;
                    -webkit-text-size-adjust: 100%;
                    outline: 1px solid #ccc; 
                    white-space: pre-wrap;       
                    white-space: -moz-pre-wrap;  
                    white-space: -pre-wrap;      
                    white-space: -o-pre-wrap;    
                    word-wrap: break-word;  
                    margin: 5px 0px;
                    
                  }
                </style>
        </head>
        <body>
        <div class="text">
            <h1> LioranBoard Spotify Authentication (part 2) </h1>   
        <div  id="text">
        
        </div>
        <div>
        <p>
        <ol>
        <li>
        Right click on the red Spotify switch button in your Spotify premade deck in your Receiver - Edit commands.  <img src="https://i.imgur.com/4Boc3Vi.png" width="50px"> <br> Scroll down until you see Send to Extension command and edit these values: <img src="https://i.imgur.com/rNP30YF.png" > </li><br>
        <li>
            <code>credentials</code> = credentials you just obtained <br> 
           <code>refresh token</code> = your refresh token you just obtained<br>
            <code>last_track</code> = do not modify (it's for the extension to check the last song played in LB's memory in case you reload Transmitter) <br>
            <code>device_type</code> = device type you want to control your Spotify on. If left on default, it will get the first device it finds. <br>
            <code>device_id</code> = device ID (in case you have multiple of the same types). If you fill out all the previous values (press Done twice) and press the red Spotify switch button, your device_id will be shown in your Transmitter (in the Spotify tab). You can then copy and paste it from there. Leave blank if you have only one Spotify device type. 

          
        </li>
        <li>Click on Done and then Done again. </li>
        <li>Reload your Transmitter or press the red switch button. You should not need to press it again as it will get automatically initiated if you open/restar Transmitter.</li>
        <li>Your extension should automatically connect to Spotify now. </li>
            </ol>

       <p>
           <i>Note: If you do not see crendetials and refresh token or it says undefined/null, you did something wrong in the previous steps. Return to the first page and repeat the process. </i>
       </p>
        </p>

        </div></div>   
        

<script>

let url_string = window.location.href
let url = new URL(url_string);
let refresh_token = url.searchParams.get("refresh_token");
let credentials = url.searchParams.get("id");

document.getElementById("text").innerHTML="<p>Your credentials: <code>"+credentials+"</code> <button id='copyCred'>Copy to Clipboard</button><br><br> Your refresh token: <code>"+refresh_token+"</code><button id='copytoken'>Copy to Clipboard</button></p>"

document.getElementById("copyCred").addEventListener("click", function (){
    CopyToClipboard (credentials,'copyCred')
})

document.getElementById("copytoken").addEventListener("click", function (){
    CopyToClipboard (refresh_token,'copytoken')
})

function CopyToClipboard (value,name){
    let copyhelper = document.createElement("input");
          copyhelper.className = 'copyhelper'
          document.body.appendChild(copyhelper);
          copyhelper.value = value;
          copyhelper.select();
          document.execCommand("copy");
          document.body.removeChild(copyhelper);
          let button=document.querySelector("#"+name)
          button.innerHTML = "Copied to Clipboard";

}

</script>   
</body>
</html>
