var LBGoogleSheetsAPI=function(){const e="https://sheets.googleapis.com/v4/spreadsheets";let t=null,n="default",o=null,r=null;const a=async function(o){const r={};r.method=o.method,"GetData"!=o.type&&"default"==n&&(r.headers={Authorization:`Bearer ${t}`,Accept:"application/json","Content-Type":"application/json"}),o.body&&(r.body=JSON.stringify(o.body));const a=await fetch(e+o.query,r);let s;if(!a.ok){throw(await a.json()).error.message||"Something went wrong."}return s=await a.json()},s=async function(n){const r={method:"POST"};r.headers={Authorization:`Bearer ${t}`,Accept:"application/json","Content-Type":"application/json"},r.body=JSON.stringify({requests:[n.request],includeSpreadsheetInResponse:!1,responseIncludeGridData:!1});const a=await fetch(`${e}/${o}/:batchUpdate`,r);let s;if(!a.ok){throw(await a.json()).error.message||"Something went wrong."}return s=await a.json()},u=function(e,t){const n=e.length-1,o=(t||0)+Math.pow(26,n)*(e[0].toUpperCase().charCodeAt()-64-(n?0:1));return e.length>1?u(e.substr(1,e.length-1),o):o},i=function(){};return(i.prototype={constructor:LBGoogleSheetsAPI}).getAccessToken=function(){return t},i.prototype.setParams=function(e,n,a){t=e,o=n,r=null!=a?a:r},i.prototype.setSpreadsheetID=function(e){o=e},i.prototype.setAccessType=function(e){n=e},i.prototype.Default=function(e,t,n){const o={method:e.method,query:e.query,body:e.body};return a(o)},i.prototype.CreateSpreadsheet=function(e){const t={method:"POST",query:"",body:{properties:{title:e.Title}}};return a(t)},i.prototype.GetData=function(e,t){const n={method:"GET",query:`/${o}/values/${t}?majorDimension=${e.Dimension}&valueRenderOption=${e.Render}&key=${r}`,type:"GetData"};return a(n)},i.prototype.UpdateData=function(e,t,n){var r;let s;const u=0!=e.returnStack;e.Values.includes("{")?(valuesObj=JSON.parse(e.Values.replace(/'/g,'"')),delete valuesObj.size,delete valuesObj.name,s=Object.values(valuesObj)):s=e.Values.split("|");const i={method:"PUT",query:`/${o}/values/${t}?valueInputOption=${e.InputType}&includeValuesInResponse=${u}`,body:{range:(null==e?void 0:null===(r=e.SheetName)||void 0===r?void 0:r.length)>0?`${e.SheetName}!${e.Range}`:e.Range,majorDimension:e.Dimension,values:[s]}};return a(i)},i.prototype.ClearData=function(e,t,n){return a({method:"POST",query:`/${o}/values/${t}:clear`})},i.prototype.AppendData=function(e,t,n){let r;e.Values.includes("{")?(valuesObj=JSON.parse(e.Values.replace(/'/g,'"')),delete valuesObj.size,delete valuesObj.name,r=Object.values(valuesObj)):r=e.Values.split("|");const s={method:"POST",query:`/${o}/values/${t}:append?insertDataOption=${e.InsertType}&valueInputOption=${e.InputType}`,body:{values:[r],majorDimension:e.Dimension}};return a(s)},i.prototype.AddSheet=function(e){const t={request:{addSheet:{properties:{title:e.Name,index:e.Index,hidden:e.Hidden}}}};return s(t)},i.prototype.AutoFill=function(e,t,n){const o={request:{autoFill:{useAlternateSeries:e.useAlternateSeries,range:n}},returnData:!1};return s(o)},i.prototype.DuplicateSheet=async function(e,t,n){const o={request:{duplicateSheet:{sourceSheetId:await this.GetSheetID(e.SpreadsheetID,e.SourceSheetName).catch(e=>{LBAlert(e)})||0,insertSheetIndex:e.insertSheetIndex,newSheetName:e.newSheetName}},returnData:!1};return s(o)},i.prototype.FindReplace=function(e,t,n){const o={request:{findReplace:{find:e.find.includes("regex")?e.find.slice(6):e.find,replacement:e.replace,matchCase:e.matchCase,matchEntireCell:e.matchEntireCell,searchByRegex:!!e.find.includes("regex"),range:n}},returnData:!1};return s(o)},i.prototype.FindData=async function(e,t){e.SheetName.includes(" ")&&(e.SheetName=`'${e.SheetName}'`);const n=e.SheetName.length>0?`${e.SheetName}!${e.Range}`:e.Range,r=e.Range.split(":")[0];isNaN(e.find)?e.find=`"${e.find}"`:e.find=+e.find;e.Dimension,e.find;const s={method:"PUT",query:`/${o}/values/Lookup_Sheet!A1?includeValuesInResponse=true&responseValueRenderOption=UNFORMATTED_VALUE&valueInputOption=USER_ENTERED&fields=updatedData`,body:{range:"Lookup_Sheet!A1",values:[[`=ROW(INDEX(${n},MATCH(${e.find},${n},0)))`],[`=COLUMN(INDEX(${n},MATCH(${e.find},${n},0)))`],["=ADDRESS(A1,A2, 4)"]]}};return a(s)},i.prototype.InsertRange=function(e,t,n){const o={request:{insertRange:{range:n,shiftDimension:e.shift}},returnData:!1};return s(o)},i.prototype.SplitText=function(e,t,n){const o={request:{textToColumns:{source:n,delimiter:e.delimiter,delimiterType:"custom"}},returnData:!1};return s(o)},i.prototype.DeleteRange=function(e,t,n){const o={request:{deleteRange:{range:n,shiftDimension:e.shift}},returnData:!1};return s(o)},i.prototype.SortRange=function(e,t,n){const o=null!==e.dimIndex.match(/^[0-9]+$/)?parseInt(e.dimIndex):u(e.dimIndex),r={request:{sortRange:{range:n,sortSpecs:[{sortOrder:e.sortOrder,dimensionIndex:o}]}},returnData:!1};return s(r)},i.prototype.Randomize=function(e,t,n){return s({request:{randomizeRange:{range:n}},returnData:!1})},i.prototype.CopyPaste=async function(e,t,n){const o=`${e.TargetSheet||0}!${e.TargetRange}`,r={request:{copyPaste:{source:n,destination:await this.getGridRange(e.SpreadsheetID,o,e.TargetSheet),pasteType:e.PasteType,pasteOrientation:e.PasteOrientation}},returnData:!1};return s(r)},i.prototype.DeleteDuplicates=function(e,t,n){const o={request:{deleteDuplicates:{range:n,comparisonColumns:{sheetId:n.sheetId,dimension:e.dimension,startIndex:e.StartIndex,endIndex:e.EndIndex}}},returnData:!1};return s(o)},i.prototype.MergeCells=function(e,t,n){const o={request:{mergeCells:{range:n,mergeType:e.mergeType}},returnData:!1};return s(o)},i.prototype.UnmergeCells=function(e,t,n){return s({request:{unmergeCells:{range:n}},returnData:!1})},i.prototype.BatchUpdateData=function(e,t,n){const r=[];e.forEach(e=>{var t;let n;const o=(null==e?void 0:null===(t=e.SheetName)||void 0===t?void 0:t.length)>0?`${e.SheetName}!${e.Range}`:e.Range;e.Values.includes("{")?(valuesObj=JSON.parse(e.Values.replace(/'/g,'"')),delete valuesObj.size,delete valuesObj.name,n=Object.values(valuesObj)):n=e.Values.split("|");const a={range:o,majorDimension:e.Dimension,values:[n]};r.push(a)});const s={method:"POST",query:`/${o}/values:batchUpdate`,body:{valueInputOption:e[0].InputType,data:[r],includeValuesInResponse:!1}};return a(s)},i.prototype.GetSheetID=async function(e,t){if(""==t||0==t)return 0;const n={method:"GET",query:`/${e}`};let o=0;const r=(await a(n)).sheets.filter(e=>e.properties.title==t);if(!(r&&r[0]&&r[0].properties))throw"Google Sheets Error: Sheet not found. Make sure you provided the right sheet name.";return o=r[0].properties.sheetId},i.prototype.getGridRange=async function(e,t,n){let o;n||(o=0,t+=`0!${t}`);const r=t.match(/(^.+)!(.+):(.+$)/);var a;n&&((o=null!==(a=sessionStorage.getItem(`${e}_${r[1]}`))&&void 0!==a?a:await this.GetSheetID(e,n).catch(e=>{LBAlert(e)}))&&sessionStorage.setItem(`${e}_${r[1]}`,o));const s=r[2].match(/(\D+)(\d+)/),i=r[3].match(/(\D+)(\d+)/),l={sheetId:o,startRowIndex:s?parseInt(s[2],10)-1:null,endRowIndex:i?parseInt(i[2],10):null,startColumnIndex:u(s?s[1]:r[2]),endColumnIndex:u(i?i[1]:r[3],1)};return null==l.startRowIndex&&delete l.startRowIndex,null==l.endRowIndex&&delete l.endRowIndex,l},i}();"object"==typeof module&&"object"==typeof module.exports&&(module.exports=LBGoogleSheetsAPI);